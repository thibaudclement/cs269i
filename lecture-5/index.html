
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lecture-4/">
      
      
        <link rel="next" href="../lecture-6/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>P2P File-sharing Dilemma - Stanford CS269I Course Notes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#p2p-file-sharing-dilemma" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Stanford CS269I Course Notes" class="md-header__button md-logo" aria-label="Stanford CS269I Course Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Stanford CS269I Course Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              P2P File-sharing Dilemma
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Stanford CS269I Course Notes" class="md-nav__button md-logo" aria-label="Stanford CS269I Course Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Stanford CS269I Course Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    One-Sided Matching and Serial Dictatorship
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stable Two-Sided Matchings
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Online Learning and Regret Minimization
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-3-2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Top Trading Cycles
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Equilibria in Games
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    P2P File-sharing Dilemma
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    P2P File-sharing Dilemma
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#iterated-file-sharing-dilemma" class="md-nav__link">
    <span class="md-ellipsis">
      Iterated File-Sharing Dilemma
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repeated-games-with-discounting" class="md-nav__link">
    <span class="md-ellipsis">
      Repeated Games with Discounting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bittorrent-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      BitTorrent Strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recap" class="md-nav__link">
    <span class="md-ellipsis">
      Recap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Market Equilibrium
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Market Failures
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Auctions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prediction Markets and Information Cascades
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-9.5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mid-Quarter Review Party
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../guest-lecture-eric-neyman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Train an AI That Doesn't Lie
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scoring Rules
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../guest-lecture-kshipra-bhawalkar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Incentives in Sponsored Search Auctions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proof-of-Work Blockchains
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proof-of-Stake Blockchains
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Markets
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lecture-14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Envy and Fairness
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#iterated-file-sharing-dilemma" class="md-nav__link">
    <span class="md-ellipsis">
      Iterated File-Sharing Dilemma
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repeated-games-with-discounting" class="md-nav__link">
    <span class="md-ellipsis">
      Repeated Games with Discounting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bittorrent-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      BitTorrent Strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recap" class="md-nav__link">
    <span class="md-ellipsis">
      Recap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="p2p-file-sharing-dilemma">P2P File-Sharing Dilemma</h1>
<p><em>April 14, 2025</em></p>
<p><strong>P2P File-Sharing History:</strong></p>
<ul>
<li>Napster (1999-2001)<ul>
<li>Major file-sharing network at the time (mostly .mp3 music files)</li>
<li>Represented an estimated 40\%-60\% of college dorms Internet traffic</li>
<li>Network shut down in 2001 due to copyright infringement</li>
</ul>
</li>
<li>Gnutella (2000 onwards).<ul>
<li>Decentralized P2P file-sharing network, harder to shut down</li>
<li>2010 court order to shut down popular client LimeWire (other clients remain available, but the popularity of the network is in decline)</li>
</ul>
</li>
</ul>
<p><strong>Challenge: Free-Riding</strong></p>
<ul>
<li>P2P file-sharing networks rely on users uploading content for sharing</li>
<li>Users want to download files for free, but there aren’t really many incentives when uploading files, so some people do not want to contribute back.</li>
<li>On Gnutella, a large fraction of users only download (66\% in 2000, 85\% in 2005)</li>
</ul>
<div class="example">
<p><strong>A Simplified Game Theory Model of File-Sharing</strong></p>
<p>Game theorists usually call this the Prisoners' Dilemma.</p>
<p>Consider the following game:</p>
<ul>
<li>There are two players: Harry and Marvin.</li>
<li>Each player has two actions: "upload" and "free-ride".</li>
<li>Their payoff is <span class="arithmatex">\(-1\)</span> for uploading (due to legal risks) and <span class="arithmatex">\(+3\)</span> for dowloading, which means:</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Upload</th>
<th>Free-ride</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Upload</strong></td>
<td>(2,2)</td>
<td>(-1,3)</td>
</tr>
<tr>
<td><strong>Free-ride</strong></td>
<td>(3,-1)</td>
<td>(0,0)</td>
</tr>
</tbody>
</table>
<p>In other words:</p>
<ul>
<li>If Harry free-rides and Marvin uploads, their utility is respectively <span class="arithmatex">\(3\)</span> and <span class="arithmatex">\(-1\)</span>—and vice versa, if Harry uploads and Marvin free rides, their utility is respectively <span class="arithmatex">\(-1\)</span> and <span class="arithmatex">\(3\)</span>.</li>
<li>If they are both uploading, they both get <span class="arithmatex">\(2\)</span>: <span class="arithmatex">\(3\)</span> for downloading and <span class="arithmatex">\(-1\)</span> for uploading.</li>
<li>If they are both free riding, there is nothing happening in the network, so their utility is <span class="arithmatex">\(0\)</span>.</li>
</ul>
<p><strong>What should they do?</strong></p>
<p>For anything Marv would do, Harry would rather free ride (and vice versa), so the optimal thing for them to do is to free ride. However, if everyone free rides, there are no files available for download, so the social welfare is the worst.</p>
</div>
<h2 id="iterated-file-sharing-dilemma">Iterated File-Sharing Dilemma</h2>
<p>Let's now file-sharing dilemma game <span class="arithmatex">\(n\)</span> times.</p>
<div class="example">
<p>Harry and Marvin now repeat the file-sharing game <span class="arithmatex">\(n\)</span> times.</p>
<ul>
<li>In each iteration, they play the same file-sharing dilemma game. Their strategy may depend on past iterations.</li>
<li>Their goal is to maximize their total payoff across all iterations.</li>
</ul>
<p><strong>What should they do? How do we model this question?</strong></p>
</div>
<p><strong>One consideration:</strong> Can agents commit to a specific strategy or not? If there are two agents sharing files on the internet, it is really hard to enforce commitments towards future rounds of the game.</p>
<div class="definition">
<p><strong>Definition: Subgame Perfect Equilibrium (SPE)</strong></p>
<ul>
<li>On day <span class="arithmatex">\(n\)</span>, the agents play a Nash equilibrium.</li>
<li>On day <span class="arithmatex">\(n-1\)</span>, the agents evaluate their actions assuming that they will play a Nash equilibrium on day <span class="arithmatex">\(n\)</span>. Then, they play a Nash equilibrium for this particular game.</li>
<li>On day <span class="arithmatex">\(n-2\)</span>, we assume the agents will play an SPE in the future.</li>
<li>Etc.</li>
</ul>
</div>
<p>An SPE means that agents cannot commit to playing suboptimal strategies in the future. For instance, if the optimal action for them is to free-ride tomorrow, they cannot commit to uploading tomorrow.</p>
<p>Another way to think about this is that it is like a Nash equilibrium (they are thinking about what happens on the last day), with backward induction (they are thinking back and modeling the future with that thinking).</p>
<p>In a way, this inability to commit is almost like the opposite of the Stackelberg equilibrium where the leader cannot commit to a strategy profile even when the strategy profile is suboptimal given what the follower is doing.</p>
<p><strong>Note:</strong> Anything that Harry does will change what Marvin does, and vice versa, and Harry needs to have some model of what Marvin will do in order to determine what will maximize his utility. However, one assumption we can make is that they are never doing something that is suboptimal.</p>
<div class="example">
<p><strong>Example: SPE for the File-Sharing Dilemma Game Iterated <span class="arithmatex">\(n\)</span> Times</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>Upload</th>
<th>Free-ride</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Upload</strong></td>
<td>(2,2)</td>
<td>(-1,3)</td>
</tr>
<tr>
<td><strong>Free-ride</strong></td>
<td>(3,-1)</td>
<td>(0,0)</td>
</tr>
</tbody>
</table>
<ul>
<li>In the <span class="arithmatex">\(n\)</span>-th iteration, free-riding is the dominant strategy. Note that what happened in the past does not change incentives here.</li>
<li>In the <span class="arithmatex">\((n-1)\)</span>-th iteration, free-riding is still strategic. No matter what a player does now, both will free-ride in the next iteration.</li>
<li>By induction, free-riding is strategic in every iteration.</li>
</ul>
</div>
<h2 id="repeated-games-with-discounting">Repeated Games with Discounting</h2>
<div class="example">
<p><strong>Example: <span class="arithmatex">\((1-p)\)</span>-Discounted File-Sharing Dilemma</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>Upload</th>
<th>Free-ride</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Upload</strong></td>
<td>(2,2)</td>
<td>(-1,3)</td>
</tr>
<tr>
<td><strong>Free-ride</strong></td>
<td>(3,-1)</td>
<td>(0,0)</td>
</tr>
</tbody>
</table>
<p><strong>Random-stopping assumption:</strong> We are playing—possibly forever, when <span class="arithmatex">\(p = 0\)</span>. At every iteration, we stop playing with probability <span class="arithmatex">\(p\)</span> (for instance because another player’s connection defaults, or because there was a lawsuit against the network, etc.).</p>
<p>In other words, Harry and Marvin repeat the file-sharing game:</p>
<ul>
<li>In each iteration, they play the same file-sharing dilemma game. Now, their strategy <em>may</em> depend on past iterations.</li>
<li>At each iteration, they stop with probability <span class="arithmatex">\(p\)</span>.</li>
<li>Their goal is to maximize their total payoff across all iterations.</li>
</ul>
<p>Here, it is less obvious what players should do (due to the random stopping rule).</p>
</div>
<p><strong>Note:</strong> This is also a popular model in general (outside of file-sharing) to model interest rates because you would rather have your money today than tomorrow, so every day in the future is worth a little less.</p>
<p>One possible strategy that Harry can choose is called the Grim Trigger Strategy.</p>
<div class="definition">
<p><strong>Definition: The Grim Trigger Strategy</strong></p>
<ul>
<li>If there was ever a time when Marvin did not upload, do not upload ever again.</li>
<li>Otherwise, upload.</li>
</ul>
</div>
<p>Essentially, if there is ever a time when Marvin free-rides, then from that point on, Harry free-rides forever, but until then, he uploads. This is all about making a threat: if Marvin ever stops sharing, then Harry will stop sharing with him. Note however that, on the last day, there is no threat, because there is no future.</p>
<p>Let's analyze Marvin’s optimal strategy, given that Harry is playing the Grim Trigger Strategy. We are assuming that Marvin believes that Harry will actually play Grim Trigger (we will see later why this is a possible assumption). In this scenario, Marvin’s optimal strategy is either to always upload or to never upload, and which one is optimal depends on <span class="arithmatex">\(p\)</span>.</p>
<div class="example">
<p><strong>Analysis: Marvin's Strategy When Harry Plays The Grim Trigger</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>Upload</th>
<th>Free-ride</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Upload</strong></td>
<td>(2,2)</td>
<td>(-1,3)</td>
</tr>
<tr>
<td><strong>Free-ride</strong></td>
<td>(3,-1)</td>
<td>(0,0)</td>
</tr>
</tbody>
</table>
<p><strong>Always Uploading:</strong> If Marvin always uploads, Harry also always uploads, so every day they keep playing, Marvin has an expected payoff of <span class="arithmatex">\(2\)</span>.
This is why the payoff is basically <span class="arithmatex">\(2 \cdot the \; geometric \; sequence \; for \; (1-p)\)</span>, which comes down to <span class="arithmatex">\(2/p\)</span>.
In other words, if Marvin always uploads, his expected utility is <span class="arithmatex">\(2/p\)</span>.</p>
<p><strong>Never Uploading:</strong> If Marvin never uploads, in the first iteration, Harry uploads, and then Harry sees that Marvin did not upload, so he is never going to upload again. The payoff for Marvin is <span class="arithmatex">\(3\)</span> for the first day, and <span class="arithmatex">\(0\)</span> for the rest of time, meaning that his utility is <span class="arithmatex">\(3\)</span>.</p>
<p><strong>Conclusion:</strong> To decide whether he should always upload or never upload, Marvin should ask when <span class="arithmatex">\(3\)</span> is greater than <span class="arithmatex">\(2/p\)</span>, which means that he should always upload when <span class="arithmatex">\(p \leq \frac{2}{3}\)</span>.</p>
</div>
<p>If Harry is playing the Grim Trigger strategy, then it makes sense for Marvin to always upload whenever <span class="arithmatex">\(p \leq \frac{2}{3}\)</span>. So, if the game ends every day with probability <span class="arithmatex">\(\frac{1}{2}\)</span>, then it makes sense for both Harry and Marvin to always upload, which is why this is an SPE.</p>
<p><strong>Question:</strong> We saw earlier that for any number of iteration <span class="arithmatex">\(n\)</span>, both players should play the strategy of never uploading. How could it be that it makes sense for Marvin to always upload whenever <span class="arithmatex">\(p \leq \frac{2}{3}\)</span>, if for any <span class="arithmatex">\(n\)</span>, the SPE is to never upload?</p>
<p>The point is that, in the random-stopping game, the players do not know in advance when the game is going to end, so any day, they are still doing the same calculations that we just did (on day <span class="arithmatex">\(7\)</span>, it is still the same as on day <span class="arithmatex">\(1\)</span>), which is why there is always an incentive to upload and make their future better, because they don’t know when the future terminates. However, when we analyze the SPE with <span class="arithmatex">\(n\)</span> days, we know when the last day is, so we can determine when there is no point uploading (because there is no future).</p>
<div class="theorem">
<p><strong>Theorem: Folk Theorem (Game Strategy)</strong></p>
<p>If the players are patient enough, then repeated interaction can result in virtually any average payoff in an SPE equilibrium.</p>
</div>
<p>In other words, the Folk theorem gives general conditions on when Harry can incentivize Marvin to play certain actions (e.g., uploading) using threats like the Grim Trigger strategy.</p>
<p>On issue with the Grim Trigger strategy is that, if for some reason, Marvin's connection goes down one day and he cannot upload, then Harry will never upload again, and Marvin in turn will not upload again, so they get stuck with a utilit of <span class="arithmatex">\(0\)</span> until the end of the game.</p>
<p>A more practical, robust alternative to the Grim Trigger strategy is called the Tit-for-Tat strategy.</p>
<div class="definition">
<p><strong>Definition: The Tit-for-Tat Strategy</strong></p>
<ul>
<li>In stage <span class="arithmatex">\(1\)</span>, upload.</li>
<li>In stage <span class="arithmatex">\(i\)</span>, reproduce the action of the other player on stage <span class="arithmatex">\(i-1\)</span>.</li>
</ul>
</div>
<div class="example">
<p><strong>Analysis: Marvin's Choices When Playing Tit-for-Tat</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>Upload</th>
<th>Free-ride</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Upload</strong></td>
<td>(2,2)</td>
<td>(-1,3)</td>
</tr>
<tr>
<td><strong>Free-ride</strong></td>
<td>(3,-1)</td>
<td>(0,0)</td>
</tr>
</tbody>
</table>
<p>At stage <span class="arithmatex">\(i\)</span>, Marvin can:</p>
<ul>
<li>Upload on stage <span class="arithmatex">\(i\)</span> (utility of <span class="arithmatex">\(-1\)</span>), and then download on stage <span class="arithmatex">\(i+1\)</span> (utility of <span class="arithmatex">\(+3\)</span>) with probability <span class="arithmatex">\((1-p)\)</span>, because there is the probability that there is no next day.</li>
<li>Not upload on stage <span class="arithmatex">\(i\)</span> (utility of <span class="arithmatex">\(0\)</span>), and then not download on stage <span class="arithmatex">\(i+1\)</span> (utility of <span class="arithmatex">\(0\)</span>).</li>
</ul>
<p><strong>Conclusion:</strong> To decide whether he should always upload or never upload, Marvin should ask when <span class="arithmatex">\(-1 + 3 \cdot (1-p) \geq 0\)</span>, which means that he should always upload whenever <span class="arithmatex">\(p \leq \frac{2}{3}\)</span>.</p>
</div>
<p><strong>Notes:</strong></p>
<ul>
<li>The conclusion is the same for Tit-for-Tat as for Grim Trigger, but this is a coincidence: in general, Grim Trigger is a stronger threat.</li>
<li>When <span class="arithmatex">\(p = \frac{2}{3}\)</span>, then both “always upload” “never upload” are strategic.</li>
</ul>
<div class="summary">
<p><strong>Iterated File-Sharing Dilemma Recap</strong></p>
<ol>
<li>In a one-shot game, free-riding is a strictly dominant strategy, i.e. for any action Marvin takes, Harry is always better of <em>not</em> uploading.</li>
<li>With any fixed number of iterations, free-riding is the SPE.</li>
<li>With a random number of iterations, a credible threat of future retaliation can lead to cooperation.</li>
</ol>
</div>
<p>In practice, game theory predicts that:</p>
<ol>
<li>Players do not cooperate in one-round games.</li>
<li>Players do not cooperate in <span class="arithmatex">\(n\)</span>-round games.</li>
<li>Players likely cooperate in games with a random number of rounds.</li>
</ol>
<p>In fact, in the real world, we frequently observe <span class="arithmatex">\((1)\)</span> and <span class="arithmatex">\((3)\)</span>: in tourist traps, restaurants they might as well charge customers as much as they can, because they will only see them once, while in locals’ favorite spots, restaurants expect customers to come over and over, so they have incentives to serve them well.</p>
<p>What about <span class="arithmatex">\((2)\)</span>?</p>
<div class="example">
<p><strong>Experiment: Axelrod Games</strong></p>
<p>Around 1980, Professor Robert Axelrod invited friends to write computer programs for a tournament of iterated file-sharing dilemma with a fixed number of round <span class="arithmatex">\(n = 200\)</span>.</p>
<p>Out of 15 submissions, Tit-for-Tat won first place.</p>
<p><strong>Notes:</strong></p>
<ul>
<li>Tit-for-Tat can never win a head-to-head match, but encouraging cooperating leads to a higher score on average.</li>
<li>You can always do better than Tit-for-Tat: you can play Tit-for-Tat during <span class="arithmatex">\(199\)</span> rounds, and not upload in the last round, but in practice, no participant tried this strategy.</li>
</ul>
<p>Later on, Professor Axelrod invited his friends to play again. Out of 62 submissions, Tit-for-Tat won first place again.</p>
</div>
<p><strong>Note:</strong> Veritasium's <em><a href="https://www.youtube.com/watch?v=mScpHTIi-kM">What Game Theory Reveals About Life, The Universe, and Everything</a></em> YouTube video offers an excellent perspective on this topic.</p>
<p>So, in practice, <span class="arithmatex">\((2)\)</span> requires fragile assumptions: Harry assumes in round <span class="arithmatex">\(i\)</span> that <span class="arithmatex">\(\rightarrow\)</span> Marvin assumes in round <span class="arithmatex">\(i+1\)</span> that <span class="arithmatex">\(\rightarrow\)</span> Harry assumes in round <span class="arithmatex">\(i+2\)</span> that <span class="arithmatex">\(\rightarrow\)</span> ... plays optimally in round <span class="arithmatex">\(n\)</span>.</p>
<h2 id="bittorrent-strategies">BitTorrent Strategies</h2>
<div class="example">
<p><strong>Definition: BitTorrent Overview</strong></p>
<ul>
<li>BitTorrent is currently the main P2P protocol for file-sharing.</li>
<li>In 2019, BitTorrent accounted for almost 30\% of upload traffic (with major spikes after episodes of Game of Thrones).</li>
<li>Users are organized into swrams sharing the same file.</li>
<li>A decentralized tracker coordinates active users in a given swarm.</li>
<li>Each file is broken down into a number of pieces (e.g. 1,000).</li>
<li>Since users need many (all) pieces, they play the iterated file-sharing dilemma game.</li>
</ul>
</div>
<div class="definition">
<p><strong>Definition: The BitTorrent Default Strategy</strong></p>
<p>This is the strategy most users play because they just download the default BitTorrent client that uses this strategy by default:</p>
<ul>
<li>Every 15-30 minutes, a user contact the tracker, requesting a new random subset of swarm peers. So, their number of known swarm peers grows over time.</li>
<li>Each user attempts to download from their peers.</li>
<li>Each user has <span class="arithmatex">\(s\)</span> slots and allocates <span class="arithmatex">\(\frac{1}{s}\)</span> of upload bandwidth to each slot.</li>
<li><span class="arithmatex">\(s\)</span> peers receive a slot ("unchoked"), chosen using a variant of the Tit-for-Tat strategy: each user prioritizes peers who sends them the most data. One slot is reserved for "pity uploads" to random peers ("optimistic unchoking"), i.e. a freebee for users who do not have data yet (to give "newbies" a chance).</li>
<li>For each fixed peer, the priority is given to uploading rare file pieces.</li>
</ul>
</div>
<div class="definition">
<p><strong>Definition: The BitThief Strategy</strong></p>
<ul>
<li>Never upload anything.</li>
<li>Ask tracker for peers much more frequently (to grow the number of peers quickly).</li>
</ul>
<p>The idea is to maximize the chances of optimistic unchoke. In experiements, though, this strategy is <span class="arithmatex">\(5x\)</span> slower than the default BitTorrent strategy. It still completes downloads in reasonable time without any uploads.</p>
</div>
<div class="definition">
<p><strong>Definition: The BitTyrant Strategy</strong></p>
<p>In the Tit-for-Tat/BitTorrent strategy, the idea is to upload data to peers who send you the most data.</p>
<p>In contrast, in the BitTyrant strategy, the idea is to upload data to peers who <em>will</em> send you the most data:</p>
<ul>
<li>For each peer <span class="arithmatex">\(j\)</span>, estimate the amount of upload <span class="arithmatex">\(u_j\)</span> so that <span class="arithmatex">\(j\)</span> unchokes you.</li>
<li>For each peer <span class="arithmatex">\(j\)</span>, estimate the speed of dowload <span class="arithmatex">\(d_j\)</span> if <span class="arithmatex">\(j\)</span> unchockes you.</li>
<li>Prioritize sending as much data as possible to peer with the maximum <span class="arithmatex">\(\frac{d_j}{u_j}\)</span> ratio.</li>
</ul>
<p>In other words, the rationale is to look for peers who will give you the most data if you give them a little bit of data.</p>
<p>In experiments, this provides <span class="arithmatex">\(\approx 70\%\)</span> download speed gains over the standard BitTorrent strategy.</p>
</div>
<div class="summary">
<p><strong>BitTorrent Strategies Recap</strong></p>
<ul>
<li><strong>Tit-for-Tat (default):</strong> Prioritize sendint data to peers who send you the most data. Reserve one upload slot for new users ("optimistic unchoke").</li>
<li><strong>BitThief:</strong> Don't upload anything. Contact as many peers as possible to maximize chances of optimistic unchoke.</li>
<li><strong>BitTyrant:</strong> Prioritize sending data to peers who would send you the most data in return.</li>
</ul>
</div>
<h2 id="recap">Recap</h2>
<div class="summary">
<p><strong>P2P File-Sharing Recap</strong></p>
<ul>
<li><strong>Free-riding</strong> Users only download, and don't contribute uploads to others.</li>
<li><strong>One-shot file-sharing dilemma:</strong> Free-riding is a dominant strategy.</li>
<li><strong>Iterated file-sharing dilemma:</strong> Tit-for-Tat encourages uploads.</li>
<li><strong>Subgame Perfect Equilibrium (SPE):</strong> Agents choose today's optimal strategy, assuming they will play an SPE in the future.</li>
<li><strong>BitTorrent (decentralized Tit-for-Tat):</strong> Free-riding is possible on optimistic unchokes. Strategizing over which peers give the best return for uploads is also possible.</li>
</ul>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.sections"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js"></script>
      
        <script src="../javascript/katex-init.js"></script>
      
    
  </body>
</html>